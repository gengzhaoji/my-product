import{_ as R}from"./my-list-panel-dba34f6a.js";import{_ as z}from"./my-table-2797da89.js";import{_ as G}from"./my-input-f162dbbb.js";import{a as S,A as B,f as E,u as e,L as A,g as L,ad as U,a6 as q,H as J,c as Q,b as c,h as s,w as p,d as W,o as X,t as P,P as Y}from"./index-a360b131.js";/* empty css                */import{_ as Z}from"./my-date-picker-3a98e3f5.js";import{_ as ee}from"./my-box-a135ed03.js";import{l as j}from"./lodash-89761a40.js";import{a as te,c as H,m as O,d as K}from"./autoImport-facafd67.js";/* empty css                 *//* empty css               */import"./el-select-4ba0ef32.js";import"./el-scrollbar-922a1011.js";import"./strings-41f0a66e.js";import"./isEqual-dc73e6ec.js";import"./el-checkbox-63c4bf05.js";/* empty css                  *//* empty css                   */const oe=a=>S({method:"get",data:a,url:B+"/decisioCommand/emergencyInfo/publishInfo"}),ne=a=>S({method:"get",data:a,url:B+"/decisioCommand/emergencyInfo/publishInfoList"}),le=a=>S({method:"get",data:a,url:B+"/decisioCommand/emergencyInfo/eventList"});function v(a){return typeof a=="function"?a==null?void 0:a():a}function M({queryFormItem:a=[],queryParams:u={},state:_={total:0,list:[]},api:i={},id:h="id",dialog:n={name:"insert",title:"窗口"},refTable:b,refDialogFrom:C}={}){const y=E(()=>{if(e(n).name==="insert")return`新增${e(n).title}`;if(e(n).name==="update")return`修改${e(n).title}`;if(e(n).name==="detail")return`${e(n).title}详情`}),x=E(()=>{let o=[];return e(_).columns.forEach(t=>{t.sortable&&o.push(t.prop)}),o});function f(){var o,t;(t=(o=e(b))==null?void 0:o.loadData)==null||t.call(o)}function D({column:o,prop:t,order:l}){var d,m;g(),e(u)[t]=l==="ascending",(m=(d=e(b))==null?void 0:d.reload)==null||m.call(d)}function g(){for(const o of x)e(u)[o]=""}function r(o,t){let l=j.clone(e(u));return e(a)&&e(a).filter(m=>m.itemType==="date"&&m.type.match(/range/gi)).forEach(m=>{const{prop:$,prepend:N}=m;l=te(l,$,N)}),v(i).page({pageNum:o,pageSize:t,...l}).then(d=>{var m,$;e(_).total=(m=d.data)==null?void 0:m.total,e(_).list=($=d.data)==null?void 0:$.rows})}function w(){resetForm(e(C)),e(n).name="insert",e(n).open=!0,e(n).form.id=void 0}function V(o){const t=e(b);Array.isArray(o)?H("此操作将删除选中数据, 是否继续?").then(()=>{v(i).remove({ids:o.map(l=>l[h]).join(",")}).then(()=>{var l;o.length===e(_).list.length?(l=t==null?void 0:t.prevFn)==null||l.call(t):f(),O("删除成功")})}).catch(()=>{K("已取消删除！")}):H("此操作将删除该条数据, 是否继续?").then(()=>{v(i).remove({ids:`${o[h]}`}).then(()=>{var l;e(_).list.length===1?(l=t==null?void 0:t.prevFn)==null||l.call(t):f(),O("删除成功")})}).catch(()=>{K("已取消删除！")})}function F(o,t){e(n).name=t,v(i).info?v(i).info({id:o[h]}).then(l=>{n.open=!0,A(()=>{e(n).form=l.data})}):(e(n).open=!0,A(()=>{e(n).form=j.clone(o)}))}function I(o){F(o,"update")}function T(o){F(o,"detail")}function k(){var l;const o=e(C);(((l=o==null?void 0:o.$refs)==null?void 0:l.refMyForm)||o).validate(d=>{d&&v(i)[e(n).name==="insert"?"add":"edit"](e(n).form).then(m=>{O(`${e(n).name==="insert"?"新增成功！":"修改成功！"}`),e(n).open=!1,f()})})}return{dialogTitle:y,getList:f,sortChange:D,orderKeysFn:g,loadData:r,insertFn:w,deleteFn:V,updateFn:I,detailFn:T,dialogSubmitFn:k}}const ae={class:"w100 h100 flex p-t-26 p-x-10 p-b-10"},se={class:"f1 w0 flex-col"},re={class:"f-s-24 m-y-10"},ie={class:"pre overflow-y-auto",style:{"max-height":"100px","line-height":"1.8rem"}},me={class:"flex"},pe={class:"flex-center m-l-10"},de={class:"flex-center m-l-10"},ce={class:"flex"},fe={class:"flex-center m-l-10"},ue={class:"flex-center m-l-10"},_e=W({name:"/MakeDecision/emergency"}),Be=Object.assign(_e,{setup(a){let u=L({});oe().then(g=>{u.value=g.data});let _=[{itemType:"date",prop:"date",type:"daterange",prepend:"CreateTime"}],i=L({date:[],needCount:!0}),h=U({total:0,list:[]});const n=q(null),{loadData:b}=M({queryFormItem:_,queryParams:i,state:h,api:{page:ne},refTable:n});let C=[{itemType:"date",prop:"date",type:"daterange"}],y=L({date:[],needCount:!0}),x=U({total:0,list:[]});const f=q(null),{loadData:D}=M({queryFormItem:C,queryParams:y,state:x,api:{page:le},refTable:f});return(g,r)=>{const w=ee,V=Z,F=J("Search"),I=Y,T=G,k=z,o=R;return X(),Q("div",ae,[c("div",se,[s(w,{title:"信息发布"},{default:p(()=>[c("h3",re,"《"+P(e(u).publishTitle)+"》",1),c("p",ie,P(e(u).publishContent),1)]),_:1}),s(w,{class:"f1 h0 m-t-10",title:"信息列表"},{right:p(()=>[c("div",me,[c("div",pe,[s(V,{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",modelValue:e(i).date,"onUpdate:modelValue":r[0]||(r[0]=t=>e(i).date=t)},null,8,["modelValue"])]),c("div",de,[s(T,{modelValue:e(i).likeTitle,"onUpdate:modelValue":r[2]||(r[2]=t=>e(i).likeTitle=t),clearable:!1,placeholder:"搜索..."},{suffix:p(()=>[s(I,{class:"pointer",onClick:r[1]||(r[1]=t=>e(n).reload())},{default:p(()=>[s(F)]),_:1})]),_:1},8,["modelValue"])])])]),default:p(()=>[s(o,{ref_key:"refTable",ref:n,total:e(h).total,loadFn:e(b)},{default:p(()=>[s(k,{data:e(h).list,columns:[{prop:"publishTitle",label:"标题",width:200,showOverflowTooltip:!0},{prop:"publishContent",label:"内容",showOverflowTooltip:!0},{prop:"createBy",label:"发布人",width:70},{prop:"createTime",label:"发布时间",width:160}]},null,8,["data"])]),_:1},8,["total","loadFn"])]),_:1})]),s(w,{class:"f1 w0 m-l-10",title:"事件清单"},{right:p(()=>[c("div",ce,[c("div",fe,[s(V,{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",modelValue:e(y).date,"onUpdate:modelValue":r[3]||(r[3]=t=>e(y).date=t)},null,8,["modelValue"])]),c("div",ue,[s(T,{modelValue:e(y).search,"onUpdate:modelValue":r[5]||(r[5]=t=>e(y).search=t),clearable:!1,placeholder:"搜索..."},{suffix:p(()=>[s(I,{class:"pointer",onClick:r[4]||(r[4]=t=>e(f).reload())},{default:p(()=>[s(F)]),_:1})]),_:1},8,["modelValue"])])])]),default:p(()=>[s(o,{ref_key:"refTable2",ref:f,total:e(x).total,loadFn:e(D)},{default:p(()=>[s(k,{data:e(x).list,columns:[{prop:"createBy",label:"成员",width:70},{prop:"eventDesc",label:"事件",showOverflowTooltip:!0},{prop:"createTime",label:"时间",width:160}]},null,8,["data"])]),_:1},8,["total","loadFn"])]),_:1})])}}});export{Be as default};
